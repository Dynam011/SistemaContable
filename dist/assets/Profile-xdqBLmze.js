import{a as m,_ as E,R as t,b as h,c as b,P as r,o as se,j as e}from"./index-DSdF_8M_.js";import{C as I,c as le}from"./index.esm-C4RaOWCk.js";import{C as te,a as K}from"./CRow-BATf04BR.js";import{C as A,a as M}from"./CCardBody-BViMqAMN.js";import{C as ne,a as g}from"./CButton-BjMrz52_.js";import{c as oe,C as O}from"./cil-pencil-DXrc7YG9.js";import{u as ie,c as W}from"./DefaultLayout-CeamR_9I.js";import{C as X}from"./CCardHeader-CHF9S75-.js";import{C as H,a as U,b as G,c as D}from"./CModalHeader-DDDsM_3D.js";import{b as Y,c as ae,C as _,a as J}from"./CFormInput-2li5QlXf.js";import"./cil-people-krF7It8S.js";var $=m.forwardRef(function(a,o){var n=a.children,s=a.as,c=s===void 0?"img":s,d=a.className,l=a.orientation,f=E(a,["children","as","className","orientation"]);return t.createElement(c,h({className:b(l?"card-img-".concat(l):"card-img",d)},f,{ref:o}),n)});$.propTypes={as:r.elementType,children:r.node,className:r.string,orientation:r.oneOf(["top","bottom"])};$.displayName="CCardImage";var B=m.forwardRef(function(a,o){var n=a.children,s=a.as,c=s===void 0?"p":s,d=a.className,l=E(a,["children","as","className"]);return t.createElement(c,h({className:b("card-text",d)},l,{ref:o}),n)});B.propTypes={as:r.elementType,children:r.node,className:r.string};B.displayName="CCardText";var Q=m.forwardRef(function(a,o){var n=a.children,s=a.as,c=s===void 0?"h5":s,d=a.className,l=E(a,["children","as","className"]);return t.createElement(c,h({className:b("card-title",d)},l,{ref:o}),n)});Q.propTypes={as:r.elementType,children:r.node,className:r.string};Q.displayName="CCardTitle";var Z=m.forwardRef(function(a,o){var n=a.className,s=a.button,c=a.feedback,d=a.feedbackInvalid,l=a.feedbackValid,f=a.floatingLabel,u=a.tooltipFeedback,C=a.hitArea,i=a.id,v=a.indeterminate,S=a.inline,j=a.invalid,y=a.label,T=a.reverse,V=a.type,w=V===void 0?"checkbox":V,F=a.valid,x=E(a,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),p=m.useRef(null),k=ie(o,p);m.useEffect(function(){p.current&&v&&(p.current.indeterminate=v)},[v,p.current]);var L=function(){return t.createElement("input",h({type:w,className:b(s?"btn-check":"form-check-input",{"is-invalid":j,"is-valid":F,"me-2":C}),id:i},x,{ref:k}))},P=function(){return t.createElement(ae,{describedby:x["aria-describedby"],feedback:c,feedbackInvalid:d,feedbackValid:l,floatingLabel:f,invalid:j,tooltipFeedback:u,valid:F})},q=function(){var z;return t.createElement(Y,h({customClassName:b(s?b("btn",s.variant?"btn-".concat(s.variant,"-").concat(s.color):"btn-".concat(s.color),(z={},z["btn-".concat(s.size)]=s.size,z),"".concat(s.shape)):"form-check-label")},i&&{htmlFor:i}),y)},re=function(){return s?t.createElement(t.Fragment,null,t.createElement(L,null),y&&t.createElement(q,null),t.createElement(P,null)):y?C?t.createElement(t.Fragment,null,t.createElement(L,null),t.createElement(Y,h({customClassName:b("form-check-label stretched-link",n)},i&&{htmlFor:i}),y),t.createElement(P,null)):t.createElement("div",{className:b("form-check",{"form-check-inline":S,"form-check-reverse":T,"is-invalid":j,"is-valid":F},n)},t.createElement(L,null),t.createElement(q,null),t.createElement(P,null)):t.createElement(L,null)};return t.createElement(re,null)});Z.propTypes=h({button:r.object,className:r.string,hitArea:r.oneOf(["full"]),id:r.string,indeterminate:r.bool,inline:r.bool,label:r.oneOfType([r.string,r.node]),reverse:r.bool,type:r.oneOf(["checkbox","radio"])},ae.propTypes);Z.displayName="CFormCheck";var R=m.forwardRef(function(a,o){var n,s=a.children,c=a.as,d=c===void 0?"ul":c,l=a.className,f=a.flush,u=a.layout,C=E(a,["children","as","className","flush","layout"]);return t.createElement(d,h({className:b("list-group",(n={"list-group-flush":f},n["list-group-".concat(u)]=u,n),l)},C,{ref:o}),s)});R.propTypes={as:r.elementType,children:r.node,className:r.string,flush:r.bool,layout:r.oneOf(["horizontal","horizontal-sm","horizontal-md","horizontal-lg","horizontal-xl","horizontal-xxl"])};R.displayName="CListGroup";var N=m.forwardRef(function(a,o){var n,s=a.children,c=a.active,d=a.as,l=d===void 0?"li":d,f=a.className,u=a.disabled,C=a.color,i=E(a,["children","active","as","className","disabled","color"]),v=l==="a"||l==="button"?ne:l;return i=h(h(h(h({},(l==="a"||l==="button")&&{active:c,disabled:u,as:l,ref:o}),c&&{"aria-current":!0}),u&&{"aria-disabled":!0}),i),t.createElement(v,h({className:b("list-group-item",(n={},n["list-group-item-".concat(C)]=C,n["list-group-item-action"]=l==="a"||l==="button",n.active=c,n.disabled=u,n),f)},i),s)});N.propTypes={active:r.bool,as:r.elementType,children:r.node,className:r.string,color:se,disabled:r.bool};N.displayName="CListGroupItem";var ce=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M472,16H40A24.028,24.028,0,0,0,16,40V200H48V48H464V464H48V304H16V472a24.028,24.028,0,0,0,24,24H472a24.028,24.028,0,0,0,24-24V40A24.028,24.028,0,0,0,472,16Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='209.377 363.306 232.004 385.933 366.627 251.31 232.004 116.687 209.377 139.313 305.374 235.311 16 235.311 16 267.311 305.372 267.311 209.377 363.306' class='ci-primary'/>"];const ee=()=>{try{const a=JSON.parse(localStorage.getItem("usuario"));return a?{name:a.first_name&&a.last_name?`${a.first_name} ${a.last_name}`:a.first_name||a.last_name||a.email||"Usuario",email:a.email||"",phone:a.phone||"No registrado",role:a.rol_id||"Usuario"}:{name:"Usuario",email:"",phone:"",role:""}}catch{return{name:"Usuario",email:"",phone:"",role:""}}},je=()=>{const[a,o]=m.useState(!1),[n,s]=m.useState(!1),[c,d]=m.useState(!1),[l,f]=m.useState(ee()),[u,C]=m.useState({language:"Español",notifications:!0}),[i,v]=m.useState(l),[S,j]=m.useState({type:"",message:""});m.useEffect(()=>{f(ee())},[]);const y=()=>{v(l),o(!0)},T=x=>{const{name:p,value:k}=x.target;v({...i,[p]:k})},V=async()=>{j({type:"",message:""});try{const x=localStorage.getItem("token"),p=JSON.parse(localStorage.getItem("usuario"));if(!(await fetch(`https://culinary-school-back.onrender.com/api/users/${p.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`},body:JSON.stringify(i)})).ok)throw new Error("Error al actualizar perfil");f(i),localStorage.setItem("usuario",JSON.stringify({...JSON.parse(localStorage.getItem("usuario")),...i})),o(!1),j({type:"success",message:"Perfil actualizado correctamente."})}catch{o(!1),j({type:"error",message:"No se pudo actualizar el perfil."})}},w=x=>{const{name:p,checked:k}=x.target;C({...u,[p]:k})},F=()=>{localStorage.removeItem("token"),localStorage.removeItem("usuario"),window.location.reload()};return e.jsxs("div",{className:"container mt-4",children:[S.message&&e.jsx("div",{className:`alert ${S.type==="success"?"alert-success":"alert-danger"} mt-2`,role:"alert",children:S.message}),e.jsxs(te,{children:[e.jsx(K,{md:4,children:e.jsxs(A,{className:"text-center",children:[e.jsx($,{orientation:"top",src:"https://cdn-icons-png.flaticon.com/512/4645/4645949.png",alt:"User Avatar",className:"rounded-circle mx-auto mt-3",style:{width:"150px",height:"150px"}}),e.jsxs(M,{children:[e.jsx(Q,{children:l.name}),e.jsx(B,{className:"text-muted",children:l.role}),e.jsxs(g,{color:"primary",className:"me-2",onClick:y,children:[e.jsx(I,{icon:oe,className:"me-1"}),"Editar Perfil"]}),e.jsxs(g,{color:"secondary",onClick:()=>s(!0),children:[e.jsx(I,{icon:W,className:"me-1"}),"Configuración"]}),e.jsxs(g,{className:"text-danger",onClick:()=>d(!0),children:[e.jsx(I,{icon:ce,className:"me-2"}),"Logout"]})]})]})}),e.jsxs(K,{md:8,children:[e.jsxs(A,{children:[e.jsx(X,{children:e.jsx("h5",{children:"Información Personal"})}),e.jsx(M,{children:e.jsxs(R,{flush:!0,children:[e.jsxs(N,{children:[e.jsx("strong",{children:"Nombre:"})," ",l.name]}),e.jsxs(N,{children:[e.jsx("strong",{children:"Email:"})," ",l.email]}),e.jsxs(N,{children:[e.jsx("strong",{children:"Teléfono:"})," ",l.phone]})]})})]}),e.jsxs(A,{className:"mt-4",children:[e.jsx(X,{children:e.jsx("h5",{children:"Preferencias"})}),e.jsx(M,{children:e.jsxs(R,{flush:!0,children:[e.jsxs(N,{children:[e.jsx(I,{icon:le,className:"me-2"}),e.jsx("strong",{children:"Idioma:"})," ",u.language]}),e.jsxs(N,{children:[e.jsx(I,{icon:W,className:"me-2"}),e.jsx("strong",{children:"Notificaciones:"})," ",u.notifications?"Activadas":"Desactivadas"]})]})})]})]})]}),e.jsxs(H,{visible:a,onClose:()=>o(!1),children:[e.jsx(U,{children:e.jsx(O,{children:"Editar Perfil"})}),e.jsx(G,{children:e.jsxs(_,{children:[e.jsx(J,{className:"mb-3",type:"text",name:"name",label:"Nombre",value:i.name,onChange:T}),e.jsx(J,{className:"mb-3",type:"email",name:"email",label:"Correo Electrónico",value:i.email,onChange:T}),e.jsx(J,{className:"mb-3",type:"text",name:"phone",label:"Teléfono",value:i.phone,onChange:T})]})}),e.jsxs(D,{children:[e.jsx(g,{color:"secondary",onClick:()=>o(!1),children:"Cancelar"}),e.jsx(g,{color:"primary",onClick:V,children:"Guardar Cambios"})]})]}),e.jsxs(H,{visible:n,onClose:()=>s(!1),children:[e.jsx(U,{children:e.jsx(O,{children:"Configuración"})}),e.jsx(G,{children:e.jsx(_,{children:e.jsx(Z,{className:"mb-3",type:"checkbox",name:"notifications",label:"Activar Notificaciones",checked:u.notifications,onChange:w})})}),e.jsxs(D,{children:[e.jsx(g,{color:"secondary",onClick:()=>s(!1),children:"Cancelar"}),e.jsx(g,{color:"primary",onClick:()=>s(!1),children:"Guardar Cambios"})]})]}),e.jsxs(H,{visible:c,onClose:()=>d(!1),children:[e.jsx(U,{children:e.jsx(O,{children:"¿Estás seguro?"})}),e.jsx(G,{children:e.jsx("p",{children:"¿Quieres cerrar sesión?"})}),e.jsxs(D,{children:[e.jsx(g,{color:"secondary",onClick:()=>d(!1),children:"Cancelar"}),e.jsx(g,{color:"danger",onClick:F,children:"Cerrar Sesión"})]})]})]})};export{je as default};
